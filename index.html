<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hello1</title>
<style>
  body, html {
    margin: 0; padding: 0; height: 100%;
    background: #111;
    color: white;
    font-family: monospace, monospace;
    overflow: hidden;
  }
  #enterScreen {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
    background: #111;
    cursor: pointer;
    opacity: 0;
    animation: fadeIn 2s forwards;
  }
  #terminal {
    display: none;
    height: 100%;
    padding: 20px;
    box-sizing: border-box;
    overflow-y: auto;
  }
  #inputLine {
    width: 100%;
    background: transparent;
    border: none;
    color: white;
    font-size: 16px;
    font-family: monospace;
    outline: none;
  }
  #visitCounter {
    position: fixed;
    bottom: 10px;
    right: 10px;
    display: flex;
    align-items: center;
    font-size: 14px;
    user-select: none;
    opacity: 0.7;
  }
  #visitCounter svg {
    width: 18px;
    height: 18px;
    margin-right: 6px;
    fill: white;
  }
  @keyframes fadeIn {
    to {opacity: 1;}
  }
  @keyframes fadeOut {
    to {opacity: 0;}
  }
</style>
</head>
<body>
<div id="enterScreen">Click to Enter</div>

<div id="terminal">
  <div id="output"></div>
  <input id="inputLine" autocomplete="off" autofocus spellcheck="false" />
</div>

<div id="visitCounter" title="Website Visits" style="display:none;">
  <svg viewBox="0 0 24 24" aria-hidden="true">
    <path d="M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7zM12 17a5 5 0 110-10 5 5 0 010 10zM12 9a3 3 0 100 6 3 3 0 000-6z"/>
  </svg>
  <span id="visitCount">0</span>
</div>

<audio id="creepyAudio" loop>
  <source src="https://cdn.pixabay.com/download/audio/2021/11/30/audio_82ec75c2c6.mp3?filename=horror-suspense-112496.mp3" type="audio/mpeg" />
</audio>

<script>
  const enterScreen = document.getElementById('enterScreen');
  const terminal = document.getElementById('terminal');
  const inputLine = document.getElementById('inputLine');
  const output = document.getElementById('output');
  const visitCounter = document.getElementById('visitCounter');
  const visitCountSpan = document.getElementById('visitCount');
  const creepyAudio = document.getElementById('creepyAudio');

  enterScreen.style.color = 'white';

  enterScreen.addEventListener('click', () => {
    enterScreen.style.animation = 'fadeOut 1s forwards';
    setTimeout(() => {
      enterScreen.style.display = 'none';
      terminal.style.display = 'block';
      visitCounter.style.display = 'flex';
      creepyAudio.play();

      // Request fullscreen
      if (document.documentElement.requestFullscreen) {
        document.documentElement.requestFullscreen();
      } else if (document.documentElement.webkitRequestFullscreen) { /* Safari */
        document.documentElement.webkitRequestFullscreen();
      } else if (document.documentElement.msRequestFullscreen) { /* IE11 */
        document.documentElement.msRequestFullscreen();
      }

      appendOutput('Welcome to the terminal. Type "help" for commands.');
      inputLine.focus();
      fetchVisitCount();
    }, 1000);
  });

  function appendOutput(text) {
    output.innerHTML += text + '<br>';
    output.scrollTop = output.scrollHeight;
  }

  function fetchVisitCount() {
    fetch('/.netlify/functions/counter')
      .then(res => res.json())
      .then(data => {
        visitCountSpan.textContent = data.count;
      })
      .catch(() => {
        visitCountSpan.textContent = '?';
      });
  }

  function handleCommand(cmd) {
    cmd = cmd.trim().toLowerCase();
    if (!cmd) return;

    if (cmd === 'help') {
      appendOutput('Commands: help, snake, clear');
    } else if (cmd === 'clear') {
      output.innerHTML = '';
    } else if (cmd === 'snake') {
      appendOutput('Snake game starting...');
      startSnakeGame();
    } else {
      appendOutput('Unknown command. Type "help" for commands.');
    }
  }

  inputLine.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      const command = inputLine.value;
      appendOutput('> ' + command);
      handleCommand(command);
      inputLine.value = '';
    }
  });

  // --- Simple Snake Game ---

  function startSnakeGame() {
    terminal.style.display = 'none';

    // Create snake canvas overlay
    const snakeCanvas = document.createElement('canvas');
    snakeCanvas.id = 'snakeCanvas';
    snakeCanvas.style.position = 'fixed';
    snakeCanvas.style.top = '0';
    snakeCanvas.style.left = '0';
    snakeCanvas.style.width = '100%';
    snakeCanvas.style.height = '100%';
    snakeCanvas.style.backgroundColor = '#111';
    snakeCanvas.style.zIndex = '9999';
    document.body.appendChild(snakeCanvas);

    const ctx = snakeCanvas.getContext('2d');
    const scale = 20;
    const rows = Math.floor(window.innerHeight / scale);
    const cols = Math.floor(window.innerWidth / scale);
    snakeCanvas.width = cols * scale;
    snakeCanvas.height = rows * scale;

    let snake = [{ x: Math.floor(cols/2), y: Math.floor(rows/2) }];
    let direction = { x: 0, y: 0 };
    let food = spawnFood();
    let gameInterval;

    function spawnFood() {
      return {
        x: Math.floor(Math.random() * cols),
        y: Math.floor(Math.random() * rows)
      };
    }

    function draw() {
      ctx.fillStyle = '#111';
      ctx.fillRect(0, 0, snakeCanvas.width, snakeCanvas.height);

      ctx.fillStyle = 'white';
      for (const segment of snake) {
        ctx.fillRect(segment.x * scale, segment.y * scale, scale-1, scale-1);
      }

      ctx.fillStyle = 'red';
      ctx.fillRect(food.x * scale, food.y * scale, scale-1, scale-1);
    }

    function update() {
      if (direction.x === 0 && direction.y === 0) return;

      const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };

      // Wrap around screen
      head.x = (head.x + cols) % cols;
      head.y = (head.y + rows) % rows;

      // Check collision with self
      for (let i = 0; i < snake.length; i++) {
        if (snake[i].x === head.x && snake[i].y === head.y) {
          gameOver();
          return;
        }
      }

      snake.unshift(head);

      // Eat food
      if (head.x === food.x && head.y === food.y) {
        food = spawnFood();
      } else {
        snake.pop();
      }
    }

    function gameOver() {
      clearInterval(gameInterval);
      alert('Game Over!');
      document.body.removeChild(snakeCanvas);
      terminal.style.display = 'block';
      inputLine.focus();
    }

    function gameLoop() {
      update();
      draw();
    }

    window.addEventListener('keydown', (e) => {
      switch (e.key.toLowerCase()) {
        case 'w':
        case 'arrowup':
          if (direction.y === 1) break;
          direction = { x: 0, y: -1 };
          break;
        case 'a':
        case 'arrowleft':
          if (direction.x === 1) break;
          direction = { x: -1, y: 0 };
          break;
        case 's':
        case 'arrowdown':
          if (direction.y === -1) break;
          direction = { x: 0, y: 1 };
          break;
        case 'd':
        case 'arrowright':
          if (direction.x === -1) break;
          direction = { x: 1, y: 0 };
          break;
      }
    });

    gameInterval = setInterval(gameLoop, 100);
  }
</script>
</body>
</html>
